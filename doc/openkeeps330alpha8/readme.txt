==========================================================================

 『華和梨』用スクリプトセット OpenKEEPS Ver.3.3.0 alpha8

==========================================================================

■ Overview

  ・はじめに
  ・ファイル構成
  ・インストール方法
  ・カスタマイズ方法(テンプレート辞書)
  ・カスタマイズ方法(OpenKEEPSの機能設定)
  ・カスタマイズ方法(システム機能のカスタマイズ) ※技術情報につき読み飛ばし可
  ・SAORIモジュールの自動登録について
  ・OpenKEEPS Ver.2.xからの移行
  ・ライセンス＆ポリシー
  ・Changelog
  ・ToDo
  ・連絡先


■ はじめに

このアーカイブは、OpenKEEPS Ver.3.3.0 alpha8です。
OpenKEEPSはデスクトップアクセサリ『伺か』とその互換ソフトに対応した
プログラマブル準AIモジュール『華和梨』用スクリプトセットです。 
OpenKEEPSを用いることで、主にゴースト(ghost)と呼ばれるデスクトップ
キャラクターの作成をより容易に行うことができます。

華和梨は他の SHIORI モジュールに比べ細かい処理を行える事が特徴と
なっていますが、そのため習得には時間を要します。OpenKEEPSは華和梨の
本体イベント等挙動に関する煩多な処理を引き受けます。ゴースト制作者
（以下ベンダーと呼称）はシェルを用意し、サンプルを書き換えるだけで
簡単にゴーストを作成できます。


■ ファイル構成

アーカイブを展開すると、以下のファイルがある筈です。
ファイルの欠落、破損がないか確認して下さい。

  readme.txt ……………………………… このファイル
  changelog.txt  ………………………… 更新履歴

  kawarirc.kis …………………………… 華和梨起動時読み込み辞書サンプル
  openkeeps.kis  ………………………… OpenKEEPS設定ファイル

  openkeeps\ ……………………………… OpenKEEPS システムフォルダ
    +-plugin\  …………………………… OpenKEEPS プラグインフォルダ
      +-dict-keeps-survicefunc.kis … サービス関数群
    +-loader.kis ………………………… OpenKEEPS ローダー
    +-dict-system.kis  ………………… 栞制御用基本システム
    +-ktm-kernel.kis …………………… タスクマネージャー「KTM」
    +-dict-keeps-system.kis  ………… 内部用フレームワークコマンド群
    +-dict-keeps-baseevent.kis ……… 基本イベント処理(必須イベント)
    +-dict-keeps-etcevent.kis  ……… 基本イベント処理(その他のイベント)
    +-dict-keeps-default.kis ………… デフォルト設定
    +-dict-keeps-winlocal.kis  ……… Windows固有イベント処理
    +-dict-keeps-comm.kis  …………… コミュニケート処理
    +-dict-keeps-keypress.kis  ……… キー入力イベント処理
    +-dict-keeps-translate.kis ……… トランスレータ処理
    +-callbackdebug.kis  ……………… コマンドラインイベントデバッグ辞書

  template\  ……………………………… テンプレート辞書フォルダ
    +-another\ …………………………… 別人格用辞書フォルダ(任意)
      +-ghost-keeps-another.kis  …… キャラクター切換サンプル(任意)
    +-ghost-keeps.kis  ………………… イベント対応辞書
    +-ghost-keeps-bootend.kis  ……… 起動/終了/ゴースト切り替え反応辞書
    +-ghost-keeps-menu.kis …………… メニュー、ユーザーインターフェース辞書
    +-ghost-keeps-mouse.kis  ………… マウス反応辞書
    +-ghost-keeps-notify.kis ………… NOTIFY通知対応辞書
    +-ghost-keeps-winlocal.kis ……… Windows固有アプリイベント対応辞書
    +-ghost-keeps-comm.kis …………… コミュニケート辞書
    +-ghost-keeps-keypress.kis ……… キー入力イベント辞書
    +-ghost-keeps-translate.kis  …… トランスレータ辞書
    +-ghost-keeps-url.kis  …………… おすすめURLリスト


■ インストール方法

1.華和梨 Phase 8.2.4以降(shiori.dll)と同じフォルダに、アーカイブを展開します。
  フォルダを含んでいるので、「フォルダも展開する」方法で展開して下さい。
2.kawarirc.kisに、辞書として最初にopenkeepsフォルダ内のloader.kisを読み込むよう
  書き込みます。アーカイブ中にある、サンプルのkawarirc.kisを参考にして下さい。
3.kawarirc.kisの最終行に、KawariSystemBootコマンドを記述します。アーカイブ中に
  ある、サンプルのkawarirc.kisを参考にして下さい。
4.必要に応じて、saoriフォルダに使用したいSAORIモジュールを置きます。

以上でOpenKEEPSのインストール作業は完了です！お疲れ様です。
あとは随時辞書を書き換えて、あなただけのオリジナルゴーストにして下さい。
サンプルゴースト「きぃ＆ぷしゅう」が参考になるでしょう。

※ Ver.3.0.0から、OpenKEEPS設定ファイル、templateフォルダ以下のghost-keepsで
   始まる.kisファイル、OpenKEEPSのセーブファイル、saoriフォルダ以下にある
   SAORIモジュールは、kawarirc.kisに書かなくてもOpenKEEPSが自動検出・ロード
   するので、設定は不要です。これらの自動読み込みの解除も可能です。


■ カスタマイズ方法(テンプレート辞書)

OpenKEEPSは、templateフォルダ内のghost-keepsで始まるテンプレート辞書ファイルを
変更するだけで、ゴーストの多彩なトークを記述できるよう工夫してあります。
openkeepsフォルダ内のシステムファイルは、ユーザが書き換えなくても大丈夫です。

templateフォルダ内のghost-keepsで始まる辞書の内容を見ると、「Talk○○○」という
名前のエントリが定義されていることが分かります。これらのエントリは、エントリの
名前に対応したイベントが起きた時に華和梨が読み、本体に内容を返します。
つまり、「このイベントがこういう条件で起きたら、こう話したい」と思ったら、
OpenKEEPSユーザは、その条件に対応したエントリを見つけ、そのエントリに
会話文を定義すればいいのです。

例えば、陽子から切り替わった時、何か特別なトークを話したいのであれば、

  TalkGhostChanged.陽子 : \0\s[0]\1\s[10]\0\s[3]…\w4…\w4いいなぁ…。\e

と書くだけです。また、初回起動時に話す内容は、TalkFirstBootエントリに
設定します。

もしぴったりの条件が無かった場合、KISで一番近い条件のエントリから
条件分岐することになります。しかし、本体の通知するイベントより、はるかに
細かくエントリが設定してあります。簡単な条件分岐で済む場合が大半でしょう。
なお、どうやったら良いのか分からない条件がありましたら、公式サイト併設の
掲示板にてお問い合わせ下さい。

OpenKEEPSで使用できるエントリ名の詳細は、ghost-keeps系辞書、及びOpenKEEPS
公式サイトを参照して下さい。


■ カスタマイズ方法(OpenKEEPSの機能設定)

ネットワーク更新先URLやゴースト名、特定機能の使用ON/OFFの設定は、openkeeps.kis
で設定します。openkeeps.kisで使用ON/OFFの設定が出来る機能は、次の通りです。

・テンプレート辞書の自動読み込み
・テンプレート辞書のサブフォルダ以下への自動検索
・テンプレート辞書のサブフォルダ以下自動検索時、サブフォルダ内優先読み込み
・SAORIモジュールの自動登録
・おすすめリスト
・ポータルリスト
・ネットワーク更新
・消滅ボタン表示
・メールチェック機能
・ヘッドラインセンス
・時計合わせ
・台本コミュニケート受信
・シングル右クリックの使用
・ユーザ定義正規化
・ゴースト切り替え反応で起動時間反応の優先使用
・ゴースト切り替え反応でゴースト名(descript.txtのname)による反応

また、以下のフォルダ名はopenkeeps.kis内で変更可能です。変更する必要がない場合、
特に設定する必要はありません。

・OpenKEEPSシステムファイルのインストールフォルダ(標準では「openkeeps」)
・テンプレート辞書のインストールフォルダ(標準では「template」)
・テンプレート辞書共通の先頭の名前(標準では「ghost-keeps」)
・SAORIモジュールを自動読み込みするフォルダ(標準では「saori」)

なお、上記4項目のうち、OpenKEEPSインストールフォルダ以外は複数の内容を同時に設定
することが出来ます。複数設定した場合、設定した全てのフォルダ名、ファイル名を検索
します。


■ カスタマイズ方法(システム機能のカスタマイズ) ※技術情報につき読み飛ばし可

openkeepsフォルダの下のpluginフォルダに拡張子が.kisのファイルを置くと、
OpenKEEPSロード時に自動的に読み込みます。OpenKEEPSと特に連動させたい辞書は、
ここに置いておくとよいでしょう。

OpenKEEPSが標準で対応していないイベント等に対応させたい場合、次のエントリ群に
書くことで、イベント対応を独自に書くことが可能です。特定イベントでOpenKEEPSの
機能を使いたくない場合も、対応するTalk系エントリに何も書かず、これらのエントリ
にイベント対応を書く、といった利用法があります。

  イベント ………… event.＜イベント名＞エントリ
  リソース文字列 … resource.＜リソース名＞エントリ
  NOTIFY …………… notify.＜NOTIFY名＞エントリ

これらエントリはOpenKEEPSが呼び出す時、エントリ内の全ての文を評価・実行します。
なお、OpenKEEPS自身もこのエントリ呼び出し方式で動いています。従って、OpenKEEPS
の機能と平行して何らかの機能を追加する、といったことも可能です。


■ SAORIモジュールの自動登録について

Ver.3.0.0から、saoriフォルダに置いた.dll拡張子をもつSAORIモジュールは、
OpenKEEPS起動時に使用SAORIモジュールとして自動的に登録するようになりました。
例えば、SAORIモジュールのファイル名を「AbcXyz.dll」とします。すると、使う時は

  $(callsaori AbcXyz [引数...])

といったように、モジュールのファイル名のうち、拡張子を除いたものがエイリアス
になっています。


■ OpenKEEPS Ver.2.xからの移行

Ver.2.xからVer.3.xへの移行にあたり、必要な作業は次の通りです。

0.OpenKEEPS Ver.3.xをインストールする
1.ghost-keepsで始まるテンプレート辞書ファイルを、ghost\master\templateフォルダに
  移動させる
2.旧dict-keeps-setting.kisの内容を、openkeeps.kisの対応する箇所にコピーする
3.ghost-keeps.kis内のhomeurlの記述を、openkeeps.kisの対応する箇所に移動する
4.kawarirc.kisのdict-keepsで始まる制御辞書、shiori-essential.kisの記述を消す
5.kawarirc.kis中、shiori-essential.kisの記述があった箇所に、次の一行を追加する

    load openkeeps\loader.kis;

6.kawarirc.kis中、セーブファイルを読み込む記述を削除する
7.kawarirc.kis最終行付近、「辞書読み込み後処理」の項を削除し、次の一行を追加する

    KawariSystemBoot;


ご覧の通り、テンプレート辞書の書き換え、単語辞書の書き換え作業などはほとんど
必要ありません。Ver.3.xは、テンプレート辞書レベルでVer.2.xと互換性があります。
Ver.3.xは従来から比べ安定性と速度が向上しており、ゴーストの「無意識部分」の
処理が充実しています。安心して移行していただけると信じています。


■ ライセンス＆ポリシー

"OpenKEEPS" 及び、公式サイト上の全てのコンテントは、特段の記載が
ない限り、OpenKEEPSプロジェクトチームが著作者であり、その著作権及び
著作者人格権を保有します。

ゴーストベンダーは "OpenKEEPS" の全部または一部を改変・抜粋して自作
ゴーストのデータに含めることができます。OpenKEEPSプロジェクトチームへの
報告を必要としません。

公式サイトへのリンクは、ホームページを含む全てのコンテントにおいて、
自由に行なって構いません。バナーは下記の画像をご利用下さい。
http://keeps.sourceforge.jp/banner.png


■ Changelog

 * changelog.txtに記載

■ ToDo

*内部を「高レベルイベント層生成部」「イベントエントリ選択部」に階層化
*ユーザ提示エントリ名を日本語化したバージョンを作成

■ 連絡先

公式サイト
http://keeps.sourceforge.jp/

"OpenKEEPS" に関するご意見やご質問は併設の掲示板に書き込み下さい。
スタッフが随時見回り、必要に応じて返信致します。また、公式サイトに
関するご意見・ご質問はsato-@users.sourceforge.jp宛にお願いします。

(c)2003-2005 OpenKEEPS Project Team
